from ..JWT import JWT

class jwt_test():
  
  def test():
    
    id_token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IlQxU3QtZExUdnlXUmd4Ql82NzZ1OGtyWFMtSSJ9.eyJhdWQiOiJmZDcyMGRlMy0zMDJkLTRmMmYtOTdmOC05Zjc4ZDA1ZjQ2Y2YiLCJpc3MiOiJodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vYjIwYTI4MjItNTI2MC00ZWE3LWIwMDAtYzE3MTMxMzg5YjMzL3YyLjAiLCJpYXQiOjE3MDMyNTY0MDAsIm5iZiI6MTcwMzI1NjQwMCwiZXhwIjoxNzAzMjYwMzAwLCJlbWFpbCI6Ik1hcmMuUGhhbUBhZHVuZW8uY29tIiwibm9uY2UiOiJkZTliYjk5Yi1iMzMxLTQ1ZWEtOGQwOS1mYTIyN2UxYTAxN2EiLCJyaCI6IjAuQVNFQUlpZ0tzbUJTcDA2d0FNRnhNVGliTS1NTmN2MHRNQzlQbF9pZmVOQmZScy1HQUtzLiIsInN1YiI6IlRIYkpNVjc3MmFXRlF5MDROYWVsR2NrSlJ6OU9JamlpSW9IempERERFZ0kiLCJ0aWQiOiJiMjBhMjgyMi01MjYwLTRlYTctYjAwMC1jMTcxMzEzODliMzMiLCJ1dGkiOiJycHl0SjRhb0swV2tNZnVjcFZtM0FBIiwidmVyIjoiMi4wIn0.Oj4un488ianQ1Dc5wmMWOLJ7MX7nug35mDgKk016LRpfg0UwKM0p6o1k8UbpQtV_rvg7Y5f6VqlpkyzCZMpape726GAf4-qa_Uc5bKlHceumfC10lmtqXtMxMgzvEltpwj9tJiTl14gMtKtWtn5efQjH7n8FlaFv6YIj6ssl-WS9_nF6n_J_8EWnpD6k12hi1oLD8UQJ2wPk4ch7o6tglWnK6399YQz6RNC2ng5XOqCX_-CBYH147_R4GDZ2AJLAin50Xt58cBEd_Tz_I57ovZ1fEU-ahqsqMbs3mn6HUYIWXwSvKPAuxrfkUNcYnOvj5nJF6ype8Xg3OwojRDdlMw"
    key = {
      "kty": "RSA",
      "use": "sig",
      "kid": "T1St-dLTvyWRgxB_676u8krXS-I",
      "x5t": "T1St-dLTvyWRgxB_676u8krXS-I",
      "n": "s2TCRTB0HKEfLBPi3_8CxCbWirz7rlvzcXnp_0j3jrmb_hst0iiHifSBwE0FV1WW79Kyw0AATkLfSLLyllyCuzgoUOgmXd3YMaqB8mQOBIecFQDAHkM1syzi_VwVdJt8H1yI0hOGcOktujDPHidVFtOuoDqAWlCs7kCGwlazK4Sfu_pnfJI4RmU8AvqO0auGcxg24ICbpP01G0PgbvW8uhWSWSSTXmfdIh567JOHsgvFr0m1AUQv7wbeRxgyiHwn29h6g1bwSYJB4I6TMG-cDygvU9lNWFzeYhtqG4Z_cA3khWIMmTq3dVzCsi4iU309-c0FopWacTHouHyMRcpJFQ",
      "e": "AQAB",
      "x5c": [
        "MIIC/TCCAeWgAwIBAgIIUd7j/OIahkYwDQYJKoZIhvcNAQELBQAwLTErMCkGA1UEAxMiYWNjb3VudHMuYWNjZXNzY29udHJvbC53aW5kb3dzLm5ldDAeFw0yMzExMDExNjAzMjdaFw0yODExMDExNjAzMjdaMC0xKzApBgNVBAMTImFjY291bnRzLmFjY2Vzc2NvbnRyb2wud2luZG93cy5uZXQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCzZMJFMHQcoR8sE+Lf/wLEJtaKvPuuW/Nxeen/SPeOuZv+Gy3SKIeJ9IHATQVXVZbv0rLDQABOQt9IsvKWXIK7OChQ6CZd3dgxqoHyZA4Eh5wVAMAeQzWzLOL9XBV0m3wfXIjSE4Zw6S26MM8eJ1UW066gOoBaUKzuQIbCVrMrhJ+7+md8kjhGZTwC+o7Rq4ZzGDbggJuk/TUbQ+Bu9by6FZJZJJNeZ90iHnrsk4eyC8WvSbUBRC/vBt5HGDKIfCfb2HqDVvBJgkHgjpMwb5wPKC9T2U1YXN5iG2obhn9wDeSFYgyZOrd1XMKyLiJTfT35zQWilZpxMei4fIxFykkVAgMBAAGjITAfMB0GA1UdDgQWBBRNcCE3HDX+HOJOu/bKfLYoSX3/0jANBgkqhkiG9w0BAQsFAAOCAQEAExns169MDr1dDNELYNK0JDjPUA6GR50jqfc+xa2KOljeXErOdihSvKgDS/vnDN6fjNNZuOMDyr6jjLvRsT0jVWzf/B6v92FrPRa/rv3urGXvW5am3BZyVPipirbiolMTuork95G7y7imftK7117uHcMq3D8f4fxscDiDXgjEEZqjkuzYDGLaVWGJqpv5xE4w+K4o2uDwmEIeIX+rI1MEVucS2vsvraOrjqjHwc3KrzuVRSsOU7YVHyUhku+7oOrB4tYrVbYYgwd6zXnkdouVPqOX9wTkc9iTmbDP+rfkhdadLxU+hmMyMuCJKgkZbWKFES7ce23jfTMbpqoHB4pgtQ=="
      ],
      "issuer": "https://login.microsoftonline.com/b20a2822-5260-4ea7-b000-c17131389b33/v2.0"
    }
    
    jwt = JWT(id_token+'')
    
    print("signature", jwt.is_signature_valid(key, raise_exception=True))
    
    